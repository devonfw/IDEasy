#!/usr/bin/env bash

if [ $# != 0 ]; then
  ideasy "$@"
  return_code=$?
  if [ $return_code != 0 ]; then
    echo -e "\n\033[91mError: IDEasy failed with exit code ${return_code}\033[91m" >&2
    return ${return_code}
  fi
fi

ide_env=
if [ "${OSTYPE}" = "cygwin" ] || [ "${OSTYPE}" = "msys" ]; then
  ide_env="$(ideasy env --bash)"
else
  ide_env="$(ideasy env)"
fi
if [ $? = 0 ]; then
  eval "${ide_env}"
  if [ $# = 0 ]; then
    echo "IDE environment variables have been set for ${IDE_HOME} in workspace ${WORKSPACE}"
  fi
fi
unset ide_env
